--------------------------------------------------------------------------------------------
-- Atualizações de registros (update,insert,delete) da versão 
-- Geralmente inserts nas tabelas criadas no plsql_versao1
--------------------------------------------------------------------------------------------
declare 
    ws_passo         varchar2(20); 
    ws_count         number; 
    ws_msg_erro      varchar2(300); 
    ws_raise_execute exception;
    ws_cd_goto       number; 
    --
    procedure p_execute_immediate (p_sql varchar2) is 
    begin
        execute immediate p_sql; 
    exception when others then 
        -- Erros tratados em caso os objetos já terem sidos criados/alterados 
        if DBMS_UTILITY.FORMAT_ERROR_STACK like '%ORA-01430%' or       -- coluna já existe 
           DBMS_UTILITY.FORMAT_ERROR_STACK like '%ORA-00955%' or       -- nome já está sendo usado por um objeto existente
           DBMS_UTILITY.FORMAT_ERROR_STACK like '%ORA-02260%' or       -- a tabela só pode ter uma chave primária
           DBMS_UTILITY.FORMAT_ERROR_STACK like '%ORA-01408%' then     -- coluna já indexada (criação de index)           
            null;
        else 
            ws_msg_erro := substr('PLSQL_ATU1('||ws_Passo||'):'||DBMS_UTILITY.FORMAT_ERROR_STACK||' - '||DBMS_UTILITY.FORMAT_ERROR_BACKTRACE,1,299); 
            raise ws_raise_execute;
        end if;      
    end;
begin 
    --
    /*   TODOS os clientes já passaram por essa correçao então não é necessário executar novamente 
    ws_passo := '1';
    merge into bi_mapa_marcador t1 using 
          ( select 'DEFAULT'    cd_marcador, 100 nr_ordem, 'Padrão Google' ds_marcador, 'DWU' nm_usuario,  null svg_path, null svg_fillcolor, null svg_scale from dual union all  
            select 'UPQ-MAR-01' cd_marcador, 102 nr_ordem, 'Marcador 01'   ds_marcador, 'DWU' nm_usuario,  'M117.87,58.42c0-21.66-17.56-39.23-39.23-39.23s-39.23,17.56-39.23,39.23c0,0-.98,39.46,39.23,79.66,40.2-40.2,39.23-79.66,39.23-79.66Zm-39.23,15.94c-8.85,0-16.03-7.18-16.03-16.03s7.17-16.03,16.03-16.03,16.03,7.18,16.03,16.03-7.17,16.03-16.03,16.03Z' svg_path, '#000000' svg_fillcolor, 0.2 svg_scale from dual union all 
            select 'UPQ-NAV-01' cd_marcador, 103 nr_ordem, 'Navio >'       ds_marcador, 'DWU' nm_usuario,  'M153,88.08c-.19-.63-.76-1.06-1.42-1.06h-20.69v-25.49c0-.82-.66-1.48-1.48-1.48h-17.66c-.82,0-1.48,.66-1.48,1.48v25.49h-2.65v-25.49c0-.82-.66-1.48-1.48-1.48h-17.66c-.82,0-1.48,.66-1.48,1.48v25.49h-2.67V47.56c0-.82-.66-1.48-1.48-1.48h-17.66c-.82,0-1.48,.66-1.48,1.48v39.47h-15.15v-10.87c0-.82-.66-1.48-1.48-1.48h-11.14v-3.96c0-5.6-4.55-10.15-10.15-10.15s-10.15,4.55-10.15,10.15v3.96h-3.65c-.82,0-1.48,.66-1.48,1.48v10.87H5.69c-.51,0-.99,.27-1.26,.71-.27,.44-.29,.99-.06,1.44l6.12,11.96,1.25,2.87-5.66,4.08,135.71,3.1-7.09-4.97c-4.24-2.97-9.32-2.93-13.53,.11-4.21,3.04-9.29,3.08-13.53,.11l-.3-.21c-4.24-2.97-9.32-2.93-13.53,.11-4.21,3.04-9.29,3.08-13.53,.11l-.3-.21c-4.24-2.97-9.32-2.93-13.53,.11-4.21,3.04-9.29,3.08-13.53,.11l-.3-.21c-4.24-2.97-9.32-2.93-13.53,.11-4.21,3.04-9.29,3.08-13.53,.11l-.3-.21c-4.02-2.82-8.79-2.89-12.87-.3l.34-5.04,.11-.08c4.22-3.04,9.29-3.08,13.53-.11l.3,.21c4.24,2.97,9.32,2.93,13.53-.11,4.22-3.04,9.29-3.08,13.53-.11l.3,.21c4.24,2.97,9.32,2.93,13.53-.11,4.22-3.04,9.29-3.08,13.53-.11l.3,.21c4.24,2.97,9.32,2.93,13.53-.11,4.21-3.04,9.29-3.08,13.53-.11l.3,.21c4.24,2.97,9.32,2.93,13.53-.11,4.17-3.01,9.19-3.07,13.4-.18l16.7-10.88c.55-.36,.8-1.03,.61-1.66Z' svg_path, '#000000' svg_fillcolor, 0.3 svg_scale from dual union all  
            select 'UPQ-NAV-02' cd_marcador, 104 nr_ordem, 'Navio < '      ds_marcador, 'DWU' nm_usuario,  'M4.3,88.1c.2-.6,.8-1.1,1.4-1.1H26.4s0-25.5,0-25.5c0-.8,.7-1.5,1.5-1.5h17.7c.8,0,1.5,.7,1.5,1.5v25.5s2.6,0,2.6,0v-25.5c0-.8,.7-1.5,1.5-1.5h17.7c.8,0,1.5,.7,1.5,1.5v25.5s2.7,0,2.7,0V47.6c0-.8,.7-1.5,1.5-1.5h17.7c.8,0,1.5,.7,1.5,1.5v39.5s15.2,0,15.2,0v-10.9c0-.8,.7-1.5,1.5-1.5h11.1s0-4,0-4c0-5.6,4.6-10.2,10.2-10.2s10.2,4.6,10.2,10.2v4s3.6,0,3.6,0c.8,0,1.5,.7,1.5,1.5v10.9s4.8,0,4.8,0c.5,0,1,.3,1.3,.7,.3,.4,.3,1,0,1.4l-6.1,12-1.2,2.9,5.7,4.1-135.7,3.1,7.1-5c4.2-3,9.3-2.9,13.5,.1,4.2,3,9.3,3.1,13.5,.1l.3-.2c4.2-3,9.3-2.9,13.5,.1,4.2,3,9.3,3.1,13.5,.1l.3-.2c4.2-3,9.3-2.9,13.5,.1,4.2,3,9.3,3.1,13.5,.1l.3-.2c4.2-3,9.3-2.9,13.5,.1,4.2,3,9.3,3.1,13.5,.1l.3-.2c4-2.8,8.8-2.9,12.9-.3l-.3-5h-.1c-4.2-3.1-9.3-3.2-13.5-.2l-.3,.2c-4.2,3-9.3,2.9-13.5-.1-4.2-3-9.3-3.1-13.5-.1l-.3,.2c-4.2,3-9.3,2.9-13.5-.1-4.2-3-9.3-3.1-13.5-.1l-.3,.2c-4.2,3-9.3,2.9-13.5-.1-4.2-3-9.3-3.1-13.5-.1l-.3,.2c-4.2,3-9.3,2.9-13.5-.1-4.2-3-9.2-3.1-13.4-.2l-16.7-10.9c-.5-.4-.8-1-.6-1.7Z' svg_path, '#000000' svg_fillcolor, 0.3 svg_scale from dual union all              
            select 'UPQ-NAV-03' cd_marcador, 105 nr_ordem, 'Navio 02 >'    ds_marcador, 'DWU' nm_usuario,  'M123.7,62A2,2,0,0,0,122,61H103.25a2,2,0,0,0-2,2c0,3.73-9.5,8.06-15.42,8.67V34.4a2,2,0,0,0-2-2H34a2,2,0,0,0-2,2V71.77H27.78V52.6a1.9,1.9,0,0,0-1.9-1.9H15.49a1.9,1.9,0,0,0-1.9,1.9v5.6H6a1.9,1.9,0,0,0-1.9,1.9V73.18a2,2,0,0,0-.1.59V85.6a2,2,0,0,0,.07.48l0,.11a2,2,0,0,0,.2.44l0,.06a2,2,0,0,0,.36.4l0,0,9.67,8a2,2,0,0,0,1.27.46h91.67a2,2,0,0,0,1.82-1.17l3.66-8,11-22.55A2,2,0,0,0,123.7,62ZM36,56.08H48.61v5.84H36Zm45.83,5.84H69.22V56.08H81.83Zm-12.61,4H81.83v5.84H69.22Zm-4-4H52.61V56.08H65.22Zm-12.61,4H65.22v5.84H52.61ZM81.83,52.08H69.22V46.24H81.83Zm-16.61,0H52.61V46.24H65.22Zm-16.61,0H36V46.24H48.61ZM36,65.92H48.61v5.84H36ZM81.83,42.24H69.22V36.4H81.83Zm-16.61,0H52.61V36.4H65.22ZM36,36.4H48.61v5.84H36ZM17.39,54.5H24V71.77H17.39V54.5ZM13.58,62v9.77H7.9V62Zm92.47,29.6H16.39l-4.83-4h96.33Zm3.7-8H8V75.77H84.5c5.62,0,18.24-4.11,20.42-10.75H118.8Z' svg_path, '#000000' svg_fillcolor, 0.3 svg_scale from dual union all 
            select 'UPQ-CAM-01' cd_marcador, 106 nr_ordem, 'Caminhão >'    ds_marcador, 'DWU' nm_usuario,  'M145.92,76.22c.22-2.63-.07-4.39-1.04-7.34l-.29-.32c-4.5-5.1-8.5-3.34-15.05-5.17-.39-.11-.8-.03-1.12,.21-.32,.24-.51,.62-.51,1.02l.28,12.58c0,.71,.58,1.29,1.29,1.29h13.19v1.58h-16.76v-16.96c-3.81-1.21-7.83-1.8-11.92-1.65l-.34,26.91h-10.55v-2.4c4.94-.65,8.78-4.84,8.78-9.96v-24.63c0-1.51-1.23-2.74-2.74-2.74H13.56c-1.51,0-2.74,1.23-2.74,2.74v31.98c0,1.51,1.23,2.74,2.74,2.74h7.65s0,2.27,0,2.27h-6.41v13.04h6.13c.21-4.59,3.63-8.33,8.07-9.03v2.85c-4.51,1.02-7.34,6.51-3.48,11.57,5.58,4.3,11.76,.38,11.76-4.96,0-3.1-2.1-5.69-4.94-6.5v-2.92c4.27,.84,7.51,4.53,7.72,9H118.8c.2-4.52,3.52-8.22,7.86-9.01v2.89c-4.37,1.14-7.06,6.49-3.28,11.49,5.58,4.31,11.77,.39,11.77-4.95,0-3.18-2.2-5.83-5.15-6.57v-2.88c4.37,.76,7.72,4.48,7.93,9.02h8.54v-15.69c0-1.34-.16-2.65-.45-3.94v-3.29l-1.33-.66c.4,0,.77-.18,1.02-.5,.24-.32,.19-.72,.23-1.11Zm-122.25,9.52v-6.67H98.86v6.67H23.67Z' svg_path, '#000000' svg_fillcolor, 0.2 svg_scale from dual union all 
            select 'UPQ-AVI-01' cd_marcador, 107 nr_ordem, 'Avião >'       ds_marcador, 'DWU' nm_usuario,  'M149.16,78.81h0s-5.19-1.47-5.19-1.47c-.11-.03-.23-.06-.34-.09l-4.19-.94c-6.07-1.75-12.12-3.46-18.01-2.67-.52,.07-.98,.13-1.48,.2l.15,2.03c.2,2.76,2.6,4.83,5.36,4.63l18.68-1.37c.19-.01,.35-.08,.53-.11l2.33,1.14c-.71,.51-3.68,2.58-4.62,2.65l-21.58,1.59c-2.76,.2-5.16-1.87-5.36-4.63l-.97-4.95c-4.08,.54-4.45,.35-6.97,.67,.51-.58-11.4-11.1-11.4-11.1,0,0-1.02-1.63-4.86,.46-2.52,1.37-.26,7.56,1.59,11.66h-2.33s-37.5-19.39-37.5-19.39c0,0-8.07-4.69-12.88,1.82s7.23,12.86,21.71,24.07c3.27,2.31-17.96,3.25-17.96,3.25l-20.77-16.18-17.9,2.88,13.98,15.19-15.64,6.56,19.07,3.7,6.6-3.49,21.43,6.82s33.15,.55,52.57-1.1c11.38-.96,12.59-.49,28.47-5.07,13.09-3.3,18.23-5.9,20.85-8.52,1.8-1.79,2.32-6.88-3.36-8.23Z' svg_path, '#000000' svg_fillcolor, 0.2 svg_scale from dual union all 
            select 'UPQ-AVI-02' cd_marcador, 108 nr_ordem, 'Avião <'       ds_marcador, 'DWU' nm_usuario,  'M8.1,78.8h0s5.2-1.5,5.2-1.5c.1,0,.2,0,.3,0l4.2-.9c6.1-1.8,12.1-3.5,18-2.7,.5,0,1,.1,1.5,.2v2c-.4,2.8-2.8,4.8-5.5,4.6l-18.7-1.4c-.2,0-.3,0-.5-.1l-2.3,1.1c.7,.5,3.7,2.6,4.6,2.7l21.6,1.6c2.8,.2,5.2-1.9,5.4-4.6l1-5c4.1,.5,4.5,.3,7,.7-.5-.6,11.4-11.1,11.4-11.1,0,0,1-1.6,4.9,.5,2.5,1.4,.3,7.6-1.6,11.7h2.3s37.5-19.4,37.5-19.4c0,0,8.1-4.7,12.9,1.8,4.8,6.5-7.2,12.9-21.7,24.1-3.3,2.3,18,3.3,18,3.3l20.8-16.2,17.9,2.9-14,15.2,15.6,6.6-19.1,3.7-6.6-3.5-21.4,6.8s-33.1,.5-52.6-1.1c-11.4-1-12.6-.5-28.5-5.1-13.1-3.3-18.2-5.9-20.9-8.5-1.8-1.8-2.3-6.9,3.4-8.2Z' svg_path, '#000000' svg_fillcolor, 0.2 svg_scale from dual union all             
            select 'UPQ-TRE-01' cd_marcador, 109 nr_ordem, 'Trem >'        ds_marcador, 'DWU' nm_usuario,  'M149.51,101.04c-10.6,0-21.19,0-31.79,0,1.68-1.29,2.79-3.3,2.79-5.58,0-1.65-.59-3.15-1.54-4.36,3.29,0,6.58,0,9.87,0h1.66c-.18-.33-.21-.48-.3-.57-1.43-1.39-2.92-2.64-4.49-3.73h7.81c1.03,1,2.03,2.04,2.96,3.16,.53,.63,1,1.04,1.94,.87,6.89-1.19,11.34-8.32,9.37-15.02-1.78-6.05-6.78-9.07-13.48-9.49-8.95-.57-17.97-.19-26.96-.1-2.08,.02-3.32-.64-4.2-2.56-1.37-2.98-2.88-5.89-4.33-8.83h5.54c.89,1.76,1.77,3.53,2.62,5.31,.39,.82,.88,1.09,1.78,1.08,6.5-.04,13-.02,19.51-.02,.32,0,.65-.03,1.35-.07-7.86-6.95-16.72-10.02-26.92-9.86,.05,.13,.09,.23,.13,.34h-5.87c-.38-.28-.84-.39-1.48-.39-28.29,.03-56.57,.02-84.86,.02h-1.61v24.82H73.66v-1.63c0-3.2,0-6.41,0-9.61h5.04v16.23h9.77v-19.76h-9.77v2.28h-5.04c0-1.34,0-2.68,0-4.01,0-2.46,.87-3.34,3.33-3.34,4.42-.01,8.85-.01,13.27,0,2.39,0,3.27,.87,3.27,3.24,.01,5.01,0,10.01,0,15.02v1.66c4.44,0,8.66,0,12.89,0,6.83-.02,13.28,1.43,19.28,4.79,2.22,1.24,4.25,2.7,6.14,4.33h-8.57c-4.08-2.34-8.61-3.7-13.59-3.97-4.65-.25-9.32-.12-13.99-.16-.67,0-1.33,0-2.16,0,0,.79,.01,1.41,0,2.03-.02,.93-.24,1.61-.65,2.1h-18.57c-.41-.48-.63-1.15-.65-2.03-.02-.66,0-1.32,0-1.94h-28.71c1.37,1.37,2.69,2.67,4,3.97h-7.07c-.4-.43-.8-.86-1.18-1.3-1.9-2.23-4-3.14-6.93-2.88-2.77,.25-5.59,.05-8.38,.05-.04,.13-.08,.26-.11,.38,1.26,1.25,2.52,2.49,3.78,3.75h-7.06c-1.2-1.2-2.4-2.4-3.6-3.6-.23-.23-.56-.48-.85-.48-2.84-.04-5.68-.02-8.55-.02v9.86h7.61c-1,1.22-1.62,2.75-1.62,4.45,0,2.29,1.11,4.31,2.8,5.6-3.33,0-6.66,0-9.98,0-.34,0-.68,0-1.02,0-1.67,.06-2.73,.95-2.8,2.36-.07,1.43,1.05,2.5,2.73,2.6,.29,.02,.58,0,.87,0,47.38,0,94.75,0,142.13,.02,1.54,0,2.75-.4,3.55-1.75v-1.46c-.77-1.63-2.17-1.8-3.78-1.8ZM36.56,56.24c3.16-.06,6.31-.06,9.47,0,1.71,.03,2.66,.93,2.71,2.62,.04,1.57,.06,3.14,.06,4.72h-5.12v-2.3h-4.77v2.3h-5.11c0-1.57,.02-3.14,.06-4.72,.04-1.69,1-2.59,2.7-2.62Zm-19.96,0c3.2-.07,6.41-.07,9.62,0,1.68,.04,2.51,1.01,2.61,2.7,0,.1,0,.19,0,.29,0,1.44,0,2.89,0,4.33h-5.1v-2.28h-4.78v2.28h-5.02c0-1.56-.03-3.11,0-4.67,.03-1.67,.99-2.63,2.67-2.67Zm9.64,14.88c-3.25,.06-6.51,.06-9.76,0-1.59-.03-2.52-.97-2.55-2.59-.03-1.23,0-2.47,0-3.7h5.02v1.25h4.78v-1.25h5.1c0,1.2,.02,2.4,0,3.6-.05,1.74-.88,2.67-2.57,2.7Zm19.72,.03c-.1,0-.19,0-.29,0-1.46,0-2.91,0-4.37,0h0c-1.6-.01-3.21,.03-4.81-.02-1.64-.06-2.58-.88-2.63-2.51-.03-1.26-.04-2.53-.05-3.79h5.1v1.27h4.77v-1.27h5.11c0,1.22-.01,2.43-.04,3.65-.04,1.78-.99,2.58-2.78,2.68Zm22.71-2.82c-.03,1.85-.95,2.76-2.8,2.81-1.6,.05-3.21,.01-4.81,.01-1.55,0-3.11,.04-4.66-.02-1.71-.07-2.6-.94-2.62-2.65-.02-1.22,0-2.43,0-3.65h5.04v1.24h4.82v-1.24h5.04c0,1.17,.02,2.33,0,3.5Zm-5.04-4.75v-2.27h-4.82v2.27h-5.04c0-1.52-.02-3.05,0-4.57,.02-1.77,.93-2.73,2.69-2.77,3.16-.07,6.31-.06,9.47,0,1.75,.04,2.7,1.01,2.73,2.76,.03,1.53,0,3.05,0,4.58h-5.04Zm71.98,10.14c.86-.09,1.75-.08,2.62-.03,1.55,.07,2.53,1.04,2.55,2.43,.02,1.39-.95,2.39-2.48,2.51-.43,.04-.87,0-1.31,0,0,0,0,.02,0,.03-.48-.02-.98,0-1.45-.08-1.32-.22-2.17-1.26-2.12-2.54,.05-1.23,.9-2.19,2.19-2.32Zm-26.44,27.33c-2.93,0-5.86,0-8.79,0,1.68-1.29,2.79-3.3,2.79-5.59,0-1.65-.59-3.15-1.54-4.35,2.1,0,4.2,0,6.3,0-.95,1.2-1.54,2.7-1.54,4.35,0,2.28,1.1,4.29,2.79,5.58Zm-23.97-9.93c1.8,0,3.6,0,5.39,0-.95,1.2-1.54,2.7-1.54,4.35,0,2.29,1.1,4.3,2.79,5.59-2.63,0-5.27,0-7.9,0,1.69-1.29,2.79-3.3,2.79-5.59,0-1.65-.59-3.14-1.53-4.34Zm-34.73-4.32c1.05,1.05,2.11,2.1,3.13,3.16,.81,.83,1.62,1.17,2.79,1.17,5.92,0,11.84,0,17.76,0-.94,1.2-1.53,2.69-1.53,4.34,0,2.29,1.11,4.3,2.79,5.59-10.8,0-21.59,0-32.39,0,1.69-1.29,2.8-3.3,2.8-5.59,0-1.66-.59-3.16-1.55-4.36h3.48c-1.55-1.55-3.02-2.93-4.4-4.3h7.11Zm-21.37,8.66c0-1.7-.62-3.23-1.62-4.45h.04c-.14-.26-.18-.4-.27-.5-1.24-1.24-2.48-2.48-3.72-3.72h7.07c1.16,1.15,2.3,2.3,3.47,3.44-1.44,1.29-2.36,3.14-2.36,5.23,0,2.29,1.11,4.3,2.8,5.59-2.74,0-5.48,0-8.22,0,1.69-1.29,2.8-3.3,2.8-5.59Z' svg_path, '#000000' svg_fillcolor, 0.2 svg_scale from dual union all 
            select 'UPQ-CAR-01' cd_marcador, 110 nr_ordem, 'Carro Carga >' ds_marcador, 'DWU' nm_usuario,  'M19.95,43.41l2.7,6.36c.14,.34,.41,.6,.75,.74,.17,.07,.34,.1,.51,.1s.36-.04,.53-.11l24.85-10.53,23.72,55.96c-8.03,4.17-11.64,13.89-8.06,22.36,2.83,6.67,9.32,10.68,16.15,10.68,2.28,0,4.59-.45,6.81-1.39,8.46-3.59,12.63-13.09,9.76-21.67l38.93-16.5c.34-.14,.6-.41,.74-.75,.14-.34,.13-.71,0-1.05l-4.84-11.43c-.14-.33-.41-.6-.75-.74-.34-.13-.71-.13-1.05,0l-10.03,4.25-12.96-30.56c-.29-.7-1.1-1.02-1.79-.72l-22.11,9.37-8.46-19.95-8.54,3.62,8.46,19.95-6.42,2.88-14.89-35.13c-.07-.17-.17-.32-.3-.44-.26-.25-.6-.39-.96-.39-.18,0-.36,.04-.53,.11l-31.48,13.18c-.7,.3-1.02,1.1-.72,1.8Zm57.51,63l2.36,5.58c.22,.52,.73,.83,1.26,.83,.18,0,.36-.04,.53-.11,.7-.29,1.02-1.1,.73-1.79l-2.36-5.58c2.8-.51,5.68,.96,6.83,3.68,.18,.43,.3,.88,.38,1.32,.5,2.8-.96,5.68-3.69,6.83-.79,.33-1.61,.49-2.42,.49-2.43,0-4.73-1.42-5.74-3.79-1.15-2.72-.2-5.81,2.1-7.47Z' svg_path, '#000000' svg_fillcolor, 0.2 svg_scale from dual union all 
            select 'UPQ-PEO-01' cd_marcador, 111 nr_ordem, 'Pessoa >'      ds_marcador, 'DWU' nm_usuario,  'M109.78,91.77c-2.06,0-4.12,0-6.27,0,0-2.57,.02-4.95,0-7.33,0-.85-.18-1.46-.51-1.93v-.82h-1.22c-.09-.04-.12-.11-.22-.15-.02,.05-.04,.1-.06,.15h-5.66c.13-.21,.3-.35,.41-.58,1.22-2.71,0-5.64-2.99-7-5.01-2.28-10.04-4.51-15.07-6.72-.79-.35-1.14-.79-1.28-1.67-.52-3.48-1.16-6.94-1.75-10.41-.4-2.35-.77-4.7-1.16-7.05,.07-.02,.14-.03,.21-.05,2.15,4.76,4.3,9.53,6.44,14.29,.11-.03,.22-.06,.33-.09,.39-5.16-3.16-10-2.95-15.17,.15-3.79-2.72-7-6.52-7.44-.1-.01-.21-.02-.31-.03v-4.47c4.06-1.7,6.98-5.74,7.11-10.49,.17-6.23-4.92-11.49-11.25-11.66-6.31-.17-11.49,4.84-11.73,11.33-.16,4.33,2.4,8.28,6.15,10.29v6.16c-2.45,.88-4.91,2.31-7.02,4.55-.91,5.21-2.01,10.37-3.02,16.02,0,.29,0,.56-.02,.82-.5,7.07-1.01,14.14-1.51,21.21-.06,.85-.12,1.73,.01,2.56,1.01,6.6,2.02,13.2,3.15,19.78,.38,2.21,.32,4.23-.65,6.29-.86,1.83-1.46,3.78-2.17,5.68-2.16,5.74-4.34,11.47-6.49,17.21-1.12,2.99-.51,5.74,1.63,7.52,3.52,2.93,8.38,1.43,10.12-3.16,3.37-8.89,6.76-17.78,10.02-26.72,.52-1.42,.68-3.12,.49-4.63-.61-4.83-1.48-9.63-2.23-14.44-.38-2.42-.74-4.85-1.12-7.31,.63,0,1.08,.05,1.52,0,1.35-.17,2.07,.46,2.47,1.71,.27,.83,.73,1.6,1.18,2.58,2.3-3.09,5.51-3.42,8.91-3.36,0-.81-.08-1.45,.02-2.06,.18-1.19-.34-1.75-1.42-2.18-2.26-.9-4.45-1.98-6.68-2.95-3.59-1.55-6.81-5.24-6.34-10.47,.52-5.75,.76-11.53,1.14-17.3,.02-.38,.12-.76,.19-1.14,1.33,6.58,2.46,13.11,3.53,19.65,.37,2.24,1.5,3.8,3.59,4.71,2.36,1.02,4.7,2.09,7.04,3.14,1.24,.55,2.49,1.1,3.73,1.66v5.5c-.1-.05-.19-.09-.3-.14v6.1c-2.25,0-4.32,0-6.39,0-2.76,.01-4.15,1.4-4.15,4.17,0,6.18,0,12.37,0,18.55,0,2.88,1.34,4.28,4.19,4.28,1.11,0,2.23,0,3.35,0,.53,2.34,1.33,5.84,1.41,6.21,1.1,4.83,2.12,9.68,3.33,14.48,.82,3.25,4.02,5.15,7.17,4.52,3.28-.66,5.44-3.58,4.98-6.96-.26-1.87-.73-3.71-1.15-5.55-.51-2.26-2.05-8.89-2.93-12.7,6.26,0,12.52,0,18.78,0,2.86,0,4.24-1.41,4.24-4.25,0-6.14,0-12.27,0-18.41,0-2.94-1.38-4.33-4.28-4.34Zm-12.27-.31c0,.07-.09,.14-.14,.22h-9.63v-3.54h9.97c-.26,1.04-.3,2.14-.2,3.32Z' svg_path, '#000000' svg_fillcolor, 0.2 svg_scale from dual 
            ) t2 
        on (t1.cd_marcador = t2.cd_marcador )  
        when matched then update set t1.ds_marcador   = t2.ds_marcador, 
                                     t1.nr_ordem      = t2.nr_ordem, 
                                     t1.svg_path      = t2.svg_path, 
                                     t1.svg_fillcolor = t2.svg_fillcolor, 
                                     t1.svg_scale     = t2.svg_scale,
                                     t1.nm_usuario    = t2.nm_usuario  
        when not matched then insert (cd_marcador, nr_ordem, ds_marcador, svg_path, svg_fillcolor, svg_scale, nm_usuario) 
                            values (t2.cd_marcador, t2.nr_ordem, t2.ds_marcador, t2.svg_path, t2.svg_fillcolor, t2.svg_scale, t2.nm_usuario ); 
    --     
    ws_passo := '2';
    --
    --update etl_step set tipo_execucao = decode(tipo_comando,'INTEGRADOR_FTP','INTEGRADOR_FTP','PL/SQL','PL/SQL','ARQUIVO_SSW','ARQUIVO_SSW','FULL','INTEGRADOR','SCHEDULER','INTEGRADOR','INTEGRADOR') where tipo_execucao is null; 
    --update etl_step set tipo_comando = 'SCHEDULER'  where tipo_comando in ('INTEGRADOR','INTEGRADOR_FTP','ARQUIVO_SSW') AND comando like '%$[%]%'; 
    --update etl_step set tipo_comando = 'FULL'       where tipo_comando in ('INTEGRADOR','INTEGRADOR_FTP','ARQUIVO_SSW') AND comando not like '%$[%]%'; 
    --update etl_step set tipo_comando = 'FULL'       where tipo_comando = 'PL/SQL'; 
    --
    COMMIT; 
    --
    DELETE FROM CODIGO_DESCRICAO WHERE NDS_TABELA = 'SEM' AND NDS_TFISICA = 'LIGACAO' AND NDS_CD_CODIGO = 'SEM' AND NDS_CD_DESCRICAO = 'SEM';

    INSERT INTO CODIGO_DESCRICAO (NDS_TABELA, NDS_OWNER, NDS_TFISICA, NDS_CD_EMPRESA, NDS_CD_CODIGO, NDS_CD_DESCRICAO) VALUES ('SEM', 'DWU', 'LIGACAO' , '*', 'SEM', 'SEM');
    COMMIT;
    --    
    for a in (select rowid from goto_objeto where nvl(cd_goto_objeto,0) = 0) loop 
        select max(cd_goto_objeto)+1 into ws_cd_goto from GOTO_OBJETO; 
        update goto_objeto b set cd_goto_objeto = ws_cd_goto where b.rowid = a.rowid;
    end loop; 
    commit; 
    --
    update etl_run_param x set id_entreaspas = (select max(id_entreaspas) from etl_step_param a, etl_run_step b 
                                                 where a.step_id = b.step_id 
                                                   and a.cd_parametro = x.cd_parametro 
                                                   and b.run_id = x.run_id)
       where id_entreaspas is null;
    commit; 
    **************************************************/ 
    --
    ws_passo := '3';
    -- Propriedade de objetos 
    merge into object_attrib t1 using (select owner, navegador, screen, cd_object, 'TIT_COLOR' cd_prop, propriedade from object_attrib where cd_prop = 'FONTE_TIT') t2 
    on (t1.owner = t2.owner and t1.navegador = t2.navegador and t1.screen = t2.screen and t1.cd_object = t2.cd_object and t1.cd_prop = t2.cd_prop) 
    when not matched then insert (owner, navegador, screen, cd_object, cd_prop, propriedade) values (t2.owner, t2.navegador, t2.screen, t2.cd_object, t2.cd_prop, t2.propriedade);
    commit; 
    --
    merge into object_padrao t1 using (select tp_objeto, 'TIT_COLOR' as cd_prop, cd_tipo, label, vl_default, sufixo, script, validacao, st_personalizado, ordem, grupo, hint from object_padrao where tp_objeto = 'CONSULTA' and cd_prop = 'FONTE_TIT') t2 
    on (t1.tp_objeto = t2.tp_objeto and t1.cd_prop = t2.cd_prop) 
    when not matched then insert (tp_objeto, cd_prop, cd_tipo, label, vl_default, sufixo, script, st_personalizado, ordem, grupo, hint) values (t2.tp_objeto, t2.cd_prop, t2.cd_tipo, t2.label, t2.vl_default, t2.sufixo, t2.script, t2.st_personalizado, t2.ordem, t2.grupo, t2.hint);
    commit; 
    --
    ws_passo := '4';
    update bi_estados set cd_regiao = 'N'  where cd_estado in ('AC','AM','AP','PA','RO','RR','TO');
    update bi_cidades set cd_regiao = 'N'  where cd_estado in ('AC','AM','AP','PA','RO','RR','TO');
    update bi_estados set cd_regiao = 'NE' where cd_estado in ('AL','BA','CE','MA','PB','PE','PI','RN','SE');
    update bi_cidades set cd_regiao = 'NE' where cd_estado in ('AL','BA','CE','MA','PB','PE','PI','RN','SE');
    update bi_estados set cd_regiao = 'SE' where cd_estado in ('ES','MG','RJ','SP');
    update bi_cidades set cd_regiao = 'SE' where cd_estado in ('ES','MG','RJ','SP');
    update bi_estados set cd_regiao = 'S'  where cd_estado in ('PR','RS','SC');
    update bi_cidades set cd_regiao = 'S'  where cd_estado in ('PR','RS','SC');
    update bi_estados set cd_regiao = 'C'  where cd_estado in ('DF','GO','MS','MT');
    update bi_cidades set cd_regiao = 'C'  where cd_estado in ('DF','GO','MS','MT');
    commit;
    --
exception when others then 
    insert into bi_log_sistema (dt_log, ds_log, nm_usuario, nm_procedure) values(sysdate, 'PLSQL_TODOS('||ws_Passo||'):'||DBMS_UTILITY.FORMAT_ERROR_STACK||' - '||DBMS_UTILITY.FORMAT_ERROR_BACKTRACE, 'DWU', 'ERRO'); 
    commit; 
end; 